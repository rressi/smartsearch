# searchservice

It is a tool that loads a raw index - generated by [*makeindex*](makeindex.md) -
and implements a micro web service:

```sh
wget -o - http://localhost:5000/search?q=my+fancy+query
[10,345,2456]
```

It simply takes one query `/search` with the following parameters:
- `q`: a tree text to be searched in the index.

And returns a sorted JSON list containing ids of matching documents, the same
 ids that were passed to *makeindex* when the index was generated.  

It can be launched in this way:

```sh
searchservice -n search.myapp.com -i myindex.idx -p 5000
```

It can also be used this way:

```sh
zcat inputstream.txt.gz | \
    makeindex -id i -content c | \
    searchservice -i myindex.idx -p 5000
```


## Command line usage

```sh
$ ./searchservice.exe -h
Usage of searchservice:
  -i string
        Raw index as input file (default "-")
  -n string
        Optional HTTP host name.
  -p uint
        TCP port to be used by the HTTP server. (default 5000)
```


## How to build

The first time you need to fetch the prerequisites, you can execute `init.sh` or
just do the following:

```sh
export GOPATH=$(pwd)
go get golang.org/x/text
```

It downloads and compiles `golang.org/x/text` that we use for text 
normalization.

Then to compile `searchservice` on your machine you can run `build.sh` or just 
type the following:

```sh
export GOPATH=$(pwd)
go build src/searchservice.go
```

The generated binary file should be placed in the root folder of the project.
